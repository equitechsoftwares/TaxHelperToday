@page
@model ContactModel
@{
    ViewData["Title"] = Model.Title;
}

@if (TempData["SuccessMessage"] != null)
{
  <div class="container" style="margin-top: 20px;">
    <div class="message-banner" style="background: #27b46a; color: white; padding: 16px; border-radius: 8px; margin-bottom: 20px; position: relative; display: flex; align-items: center; justify-content: space-between; transition: opacity 0.3s ease-out;">
      <span>@TempData["SuccessMessage"]</span>
      <button type="button" class="message-close-btn" style="background: none; border: none; color: white; font-size: 20px; cursor: pointer; padding: 0; margin-left: 16px; line-height: 1; opacity: 0.8; transition: opacity 0.2s;" aria-label="Close">√ó</button>
    </div>
  </div>
}
@if (TempData["ErrorMessage"] != null)
{
  <div class="container" style="margin-top: 20px;">
    <div class="message-banner" style="background: #d34b4b; color: white; padding: 16px; border-radius: 8px; margin-bottom: 20px; position: relative; display: flex; align-items: center; justify-content: space-between; transition: opacity 0.3s ease-out;">
      <span>@TempData["ErrorMessage"]</span>
      <button type="button" class="message-close-btn" style="background: none; border: none; color: white; font-size: 20px; cursor: pointer; padding: 0; margin-left: 16px; line-height: 1; opacity: 0.8; transition: opacity 0.2s;" aria-label="Close">√ó</button>
    </div>
  </div>
}

<section class="page-hero-modern">
  <div class="hero-background"></div>
  <div class="container">
    @if (!string.IsNullOrEmpty(Model.Eyebrow))
    {
      <p class="eyebrow">@Model.Eyebrow</p>
    }
    @if (!string.IsNullOrEmpty(Model.HeroTitle))
    {
      <h1>@Html.Raw(Model.HeroTitle)</h1>
    }
    @if (!string.IsNullOrEmpty(Model.HeroText))
    {
      <p class="page-hero-text">
        @Html.Raw(Model.HeroText)
      </p>
    }
  </div>
</section>

<section class="section">
  <div class="container contact-grid">
    <div class="contact-form-wrapper">
      <div class="contact-form-card">
        <div class="form-header">
          <div class="form-icon">‚úâÔ∏è</div>
          @if (!string.IsNullOrEmpty(Model.ContactFormTitle))
          {
            <h2>@Model.ContactFormTitle</h2>
          }
          @if (!string.IsNullOrEmpty(Model.ContactFormDescription))
          {
            <p>@Html.Raw(Model.ContactFormDescription)</p>
          }
        </div>
        <form id="contact-form" method="post" class="form-modern">
          <div class="field">
            <label for="contact-name">Full Name</label>
            <input type="text" id="contact-name" name="name" required>
          </div>
          <div class="field">
            <label for="contact-email">Email</label>
            <input type="email" id="contact-email" name="email" required>
          </div>
          <div class="field">
            <label for="contact-phone">Mobile Number</label>
            <input type="tel" id="contact-phone" name="phone" pattern="[0-9]{10}" placeholder="10-digit mobile number">
          </div>
          <div class="field">
            <label for="contact-subject">Subject</label>
            <input type="text" id="contact-subject" name="subject" required>
          </div>
          <div class="field">
            <label for="contact-message">How can we help?</label>
            <textarea id="contact-message" name="message" rows="5" required></textarea>
          </div>
          @if (!string.IsNullOrEmpty(Model.ContactFormButtonText))
          {
            <button type="submit" class="btn btn-primary btn-block">@Model.ContactFormButtonText</button>
          }
          else
          {
            <button type="submit" class="btn btn-primary btn-block">Submit</button>
          }
          @if (!string.IsNullOrEmpty(Model.ContactFormNote))
          {
            <p class="form-note">
              @Model.ContactFormNote
            </p>
          }
          <p id="contact-status" class="form-status" aria-live="polite"></p>
        </form>
      </div>
    </div>
    <div class="contact-info-wrapper">
      @if (!string.IsNullOrEmpty(Model.ContactReachUsTitle))
      {
        <h2>@Model.ContactReachUsTitle</h2>
      }
      <div class="contact-info-grid">
        <div class="contact-block-modern">
          <div class="contact-icon">üìß</div>
          <div class="contact-content">
            <h3>Email</h3>
            <p><a href="mailto:@Model.ContactEmail">@Model.ContactEmail</a></p>
          </div>
        </div>
        <div class="contact-block-modern">
          <div class="contact-icon">üìû</div>
          <div class="contact-content">
            <h3>Phone</h3>
            <p><a href="tel:@Model.ContactPhone.Replace(" ", "").Replace("-", "")">@Model.ContactPhone</a></p>
          </div>
        </div>
        <div class="contact-block-modern">
          <div class="contact-icon">üïê</div>
          <div class="contact-content">
            <h3>Working hours</h3>
            <p>@Model.WorkingHours</p>
          </div>
        </div>
        <div class="contact-block-modern">
          <div class="contact-icon">üí¨</div>
          <div class="contact-content">
            <h3>Prefer WhatsApp?</h3>
            <p><a href="https://wa.me/@Model.WhatsAppNumber?text=@Uri.EscapeDataString(Model.WhatsAppMessage)" target="_blank" rel="noopener noreferrer">Drop a "Hi" with your name and city and we'll pick up from there.</a></p>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section section-alt">
  <div class="container">
    <div class="map-section-header">
      @if (!string.IsNullOrEmpty(Model.ContactFindUsTitle))
      {
        <h2>@Model.ContactFindUsTitle</h2>
      }
      @if (!string.IsNullOrEmpty(Model.ContactFindUsDescription))
      {
        <p>@Model.ContactFindUsDescription</p>
      }
    </div>
    <div class="map-wrapper">
      <div class="map-container">
        <iframe 
          src="@Model.MapUrl" 
          width="100%" 
          height="100%" 
          style="border:0;" 
          allowfullscreen="" 
          loading="lazy" 
          referrerpolicy="no-referrer-when-downgrade"
          title="TaxHelperToday Office Location">
        </iframe>
      </div>
      <div class="map-info-card">
        <div class="map-info-icon">üìç</div>
        <div class="map-info-content">
          <h3>Office Address</h3>
          <p>
            @Html.Raw(Model.OfficeAddress)
          </p>
          <a href="@Model.MapDirectionsUrl" target="_blank" class="btn btn-outline" style="margin-top: 16px;">
            Get Directions
          </a>
        </div>
      </div>
    </div>
  </div>
</section>

@section Scripts {
<script>
  document.addEventListener('DOMContentLoaded', function() {
    const messageBanners = document.querySelectorAll('.message-banner');
    
    messageBanners.forEach(function(banner) {
      // Auto-hide after 5 seconds
      const autoHideTimer = setTimeout(function() {
        hideBanner(banner);
      }, 5000);
      
      // Close button click handler
      const closeBtn = banner.querySelector('.message-close-btn');
      if (closeBtn) {
        closeBtn.addEventListener('click', function() {
          clearTimeout(autoHideTimer);
          hideBanner(banner);
        });
        closeBtn.addEventListener('mouseenter', function() {
          this.style.opacity = '1';
        });
        closeBtn.addEventListener('mouseleave', function() {
          this.style.opacity = '0.8';
        });
      }
    });
    
    function hideBanner(banner) {
      banner.style.opacity = '0';
      setTimeout(function() {
        banner.style.display = 'none';
      }, 300);
    }
  });
</script>
}
