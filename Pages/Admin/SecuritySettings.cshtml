@page
@model TaxHelperToday.Pages.Admin.SecuritySettingsModel
@{
    ViewData["Title"] = "Security Settings";
}

<section class="content-header">
    <div class="container-fluid">
        <div class="row mb-2">
            <div class="col-sm-6">
                <h1>Security Settings</h1>
            </div>
            <div class="col-sm-6">
                <ol class="breadcrumb float-sm-right">
                    <li class="breadcrumb-item"><a href="/Admin/Dashboard">Home</a></li>
                    <li class="breadcrumb-item"><a href="/Admin/Settings">Settings</a></li>
                    <li class="breadcrumb-item active">Security Settings</li>
                </ol>
            </div>
        </div>
    </div>
</section>

<section class="content">
    <div class="container-fluid">
        @if (TempData["SuccessMessage"] != null)
        {
            <div class="alert alert-success alert-dismissible fade show" role="alert">
                @TempData["SuccessMessage"]
                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
        }

        @if (TempData["ErrorMessage"] != null)
        {
            <div class="alert alert-danger alert-dismissible fade show" role="alert">
                @TempData["ErrorMessage"]
                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
        }

        <div class="row">
            <div class="col-12">
                <div class="card card-danger">
                    <div class="card-header">
                        <h3 class="card-title"><i class="fas fa-shield-alt"></i> Security Settings</h3>
                    </div>
                    <div class="card-body">
                        <h5>Active Sessions</h5>
                        <p class="text-muted">
                            If you suspect unauthorized access to your account or want to log out from all devices, 
                            you can revoke all active sessions. This will log you out from all devices including this one.
                        </p>
                        <p class="text-warning">
                            <i class="fas fa-exclamation-triangle"></i> 
                            <strong>Warning:</strong> This action cannot be undone. You will need to log in again on all devices.
                        </p>
                    </div>
                    <div class="card-footer">
                        <form method="post" asp-page-handler="LogoutAllSessions" onsubmit="return confirm('Are you sure you want to log out from all devices? This will end all active sessions including this one.');">
                            <button type="submit" class="btn btn-danger">
                                <i class="fas fa-sign-out-alt"></i> Logout All Sessions
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
